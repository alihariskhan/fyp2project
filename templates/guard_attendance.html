{% extends "navbar.html" %}
{% block body %}


<!--  Body Wrapper -->
  <div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
    data-sidebar-position="fixed" data-header-position="fixed">
    <!-- Sidebar Start -->
    <aside class="left-sidebar">
      <!-- Sidebar scroll-->
      <div>
        <div class="brand-logo d-flex align-items-center justify-content-between">
          <a href="/" class="text-nowrap logo-img">
            <h1 STYLE="font-size:20px; font-weight:900; color:black;">SHAH SECURITY</h1>
          </a>
          <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
            <i class="ti ti-x fs-8"></i>
          </div>
        </div>
        <!-- Sidebar navigation-->
        <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
          <ul id="sidebarnav">
            <li class="nav-small-cap">
              <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
              <span class="hide-menu">Home</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/" aria-expanded="false">
                <span>
                  <i class="ti ti-layout-dashboard"></i>
                </span>
                <span class="hide-menu">Website</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/supervisordashboard" aria-expanded="false">
                <span>
                  <i class="ti ti-layout-dashboard"></i>
                </span>
                <span class="hide-menu">Dashboard</span>
              </a>
            </li>
            <li class="nav-small-cap">
              <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
              <span class="hide-menu">UI COMPONENTS</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/guard_attendance" aria-expanded="false">
                <span>
                  <i class="ti ti-article"></i>
                </span>
                <span class="hide-menu">Guard Attendance</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/admincalled" aria-expanded="false">
                <span>
                  <i class="ti ti-article"></i>
                </span>
                <span class="hide-menu">Call for Interview</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/guard_detail" aria-expanded="false">
                <span>
                  <i class="ti ti-article"></i>
                </span>
                <span class="hide-menu">Guards Detail</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/guard_schedule" aria-expanded="false">
                <span>
                  <i class="ti ti-article"></i>
                </span>
                <span class="hide-menu">Guard Schedule</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/schedule_detail" aria-expanded="false">
                <span>
                  <i class="ti ti-article"></i>
                </span>
                <span class="hide-menu">Schedule Details</span>
              </a>
            </li>
            <li class="nav-small-cap">
              <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
              <span class="hide-menu">AUTH</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="/supervisor/logout" aria-expanded="false">
                <span>
                  <i class="ti ti-login"></i>
                </span>
                <span class="hide-menu">Logout</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./authentication-register.html" aria-expanded="false">
                <span>
                  <i class="ti ti-user-plus"></i>
                </span>
                <span class="hide-menu">Register</span>
              </a>
            </li>
          </ul>
        </nav>
        <!-- End Sidebar navigation -->
      </div>
      <!-- End Sidebar scroll-->
    </aside>
    <!--  Sidebar End -->
    <!--  Main wrapper -->
    <div class="body-wrapper">
      <!--  Header Start -->

      <!--  Header End -->
      <div class="container-fluid">
        <div class="container-fluid">
          <br><br>
          <div class="card">
           <form id="attendanceForm" class="form-inline justify-content-center mt-3">
        <div class="form-group mx-sm-3 mb-2">
            <label for="guardId" class="sr-only">Guard ID:</label>
            <select class="form-control" id="guardId" name="guard_id" required>
                {% for guard in guards %}
                    <option value="{{ guard.guard_id }}">{{ guard.guard_id}}. {{ guard.guard_name }}</option>
                {% endfor %}
            </select>
        </div>
        <input type="datetime-local" name="checkintime" id="checkintime">
        <button type="button" class="btn-primary mb-2" onclick="markAttendance('checkin')">Check-In</button>
        <input type="datetime-local" name="checkouttime" id="checkouttime">
        <button type="button" class="btn-success mb-2" onclick="markAttendance('checkout')">Check-Out</button>
        <button type="button" class="btn-danger mb-2" onclick="markAttendance('absent')">Absent</button>
    </form>

    
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script src="{{ url_for('static', filename='libs/bootstrap/dist/js/bootstrap.bundle.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/sidebarmenu.js') }}"></script>
  <script src="{{ url_for('static', filename='js/app.min.js') }}"></script>
  <script src="{{ url_for('static', filename='libs/simplebar/dist/simplebar.js') }}"></script>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        function markAttendance(action) {
            var guardId = document.getElementById('guardId').value;
            var checkinTime = document.getElementById('checkintime').value;
            var checkoutTime = document.getElementById('checkouttime').value;

            // Example AJAX using fetch:
            fetch('/mark_attendance', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'guard_id=' + guardId + '&action=' + action + '&checkintime=' + checkinTime + '&checkouttime=' + checkoutTime,
            })
            .then(response => {
                if (response.status === 200) {
                    return response.text(); // Return the text representation of the response
                } else {
                    throw new Error('Error: ' + response.status);
                }
            })
            .then(message => {
                alert(message); // Display the success message
            })
            .catch((error) => {
                console.error('Error:', error);
                alert('An error occurred: ' + error.message); // Display the error message
            });
        }
    </script>


{% endblock %}